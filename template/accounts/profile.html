{% extends "home.html" %}
{% load static %}

{% block title %}ADAY - Perfil de {{ user.username }}{% endblock %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{# Sobrescribimos el t√≠tulo de la barra superior para que diga ADAY #}
{% block top_title %}ADAY{% endblock %}

{# Quitamos el buscador del home en el perfil si as√≠ lo prefieres #}
{% block search %}{% endblock %}

{% block content %}
<div class="profile-container" style="padding-bottom: 80px;">
    <div class="profile-section">
        <div class="profile-avatar frame-{{ user.profile.marco }}">
            {% if user.profile.foto_perfil %}
                <img src="{{ user.profile.foto_perfil.url }}" alt="Foto de perfil" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
            {% else %}
                <svg viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            {% endif %}
            <div class="camera-badge">
                <svg viewBox="0 0 24 24">
                    <path d="M12 15.2c-1.92 0-3.5-1.58-3.5-3.5s1.58-3.5 3.5-3.5 3.5 1.58 3.5 3.5-1.58 3.5-3.5 3.5zM9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9z"/>
                </svg>
            </div>
        </div>
        <div class="profile-name">{{ user.username }}</div>
        <div class="profile-email">{{ user.email }}</div>
        <div class="profile-buttons">
            <a href="{% url 'accounts:friends' %}" class="btn btn-primary">
                <i class="fas fa-users"></i> Amigos
            </a>
            <a href="{% url 'accounts:messages_list' %}" class="btn-messages">
                <i class="fas fa-envelope"></i> Mensajes
            </a>
        </div>
    </div>

    <div class="stats-section">
        <div class="section-title">Mis Estad√≠sticas</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">{{ profile.lugares_visitados|default:0 }}</div>
                <div class="stat-label">Lugares Visitados</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ profile.fotos_tomadas|default:0 }}</div>
                <div class="stat-label">Fotos Tomadas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ amigos_count|default:0 }}</div>
                <div class="stat-label">Amigos</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ profile.dias_viajando|default:0 }}</div>
                <div class="stat-label">D√≠as Viajando</div>
            </div>
        </div>
    </div>

    <div class="achievements-section">
        <div class="section-title">Logros Desbloqueados</div>
        <div class="achievement-card">
            <div class="achievement-icon">‚òÄÔ∏è</div>
            <div class="achievement-info">
                <div class="achievement-title">Explorador Novato</div>
                <div class="achievement-subtitle">Visit√≥ 5 lugares</div>
            </div>
        </div>
        <div class="achievement-card">
            <div class="achievement-icon">üì∑</div>
            <div class="achievement-info">
                <div class="achievement-title">Fot√≥grafo Viajero</div>
                <div class="achievement-subtitle">Tom√≥ 100 fotos</div>
            </div>
        </div>
    </div>

    <div class="config-section">
        <div class="section-title">Configuraci√≥n</div>
        <a href="{% url 'accounts:edit_profile' %}" class="config-item">
            <span class="config-icon">üë§</span>
            <span class="config-text">Editar perfil</span>
        </a>
        <a href="{% url 'core:logout' %}" class="config-item">
            <div class="logout-text" style="color: #dc3545; font-weight: bold;">Cerrar sesi√≥n</div>
        </a>
    </div>
</div>

<div class="fab-camera" id="fabCamera">
    <svg viewBox="0 0 24 24"><path d="M12 15.2c-1.92 0-3.5-1.58-3.5-3.5s1.58-3.5 3.5-3.5 3.5 1.58 3.5 3.5-1.58 3.5-3.5 3.5zM9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9z"/></svg>
</div>

<div class="modal-overlay" id="cameraModal">
    <div class="camera-modal">
        <div class="modal-header">
            <h2 class="modal-title">C√°mara</h2>
            <button class="close-modal" id="closeModal">&times;</button>
        </div>
        <div class="camera-preview">
            <video id="videoElement" autoplay playsinline></video>
            <img id="capturedImage" alt="Foto capturada">
            <span class="camera-placeholder" id="cameraPlaceholder">Selecciona una opci√≥n</span>
        </div>
        <div class="capture-btn" id="captureBtn"></div>
        <div class="camera-controls" id="cameraControls">
            <button class="camera-btn camera-btn-primary" id="activateCamera">Activar C√°mara</button>
            <button class="camera-btn camera-btn-secondary" id="uploadPhoto">Subir Foto</button>
        </div>
        <div class="action-buttons" id="actionButtons" style="display:none;">
            <button class="camera-btn btn-retake" id="retakeBtn">Tomar otra</button>
            <button class="camera-btn btn-save" id="saveBtn">Guardar</button>
        </div>
        <input type="file" id="fileInput" accept="image/*" style="display:none;">
    </div>
</div>

<script src="{% static 'js/profile.js' %}"></script>
{% endblock %}